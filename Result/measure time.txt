naive implementation (synthronous without incremental): 360 second in my home machine